---
title: "MD-HT1"
output: html_document
date: "2024-01-25"
repo: https://github.com/TheDeloz-v2/MD-HT1.git 
---

## Carga de datos

```{r setup, include=FALSE}
datos <- read.csv("movies.csv")
```

## 1. Resumen de nuestro conjunto de datos

```{r movies}
summary(datos)
```

## 2. Diga el tipo de cada una de las variables (cualitativa ordinal o nominal, cuantitativa continua, cuantitativa discreta)

```{r movies}
if (!requireNamespace("knitr", quietly = TRUE)) {
  install.packages("knitr")
}

library(knitr)
# Definir manualmente los tipos de variables que son cada una
tipo <- c("Cuantitativa discreta", "Cuantitativa continua", "Cualitativa nominal",
                    "Cualitativa nominal", "Cualitativa nominal", "Cualitativa nominal",
                    "Cualitativa nominal", "Cuantitativa continua",
                    "Cuantitativa continua", "Cualitativa nominal", "Cualitativa nominal",
                    "Cualitativa nominal", "Cuantitativa continua", "Cualitativa nominal",
                    "Cualitativa nominal", "Cualitativa nominal", "Cualitativa nominal",
                    "Cuantitativa continua", "Cualitativa nominal", "Cuantitativa continua",
                    "Cuantitativa discreta", "Cuantitativa discreta", "Cuantitativa discreta",
                    "Cuantitativa discreta", "Cuantitativa discreta", "Cuantitativa discreta",
                    "Cuantitativa discreta")

# Crear un dataframe con los nombres de las columnas y los tipos que son
tabla_columnas_valores <- data.frame(Variables = colnames(datos), TipoVariable = tipo)

# Imprimir la tabla usando kable()
kable(tabla_columnas_valores, format = "html", row.names = TRUE)
```

## 3. Investigue si las variables cuantitativas siguen una distribución normal y haga una tabla de frecuencias de las variables cualitativas. Explique todos los resultados.

### budget

```{r movies}
# Descargamos ggplot2
if (!requireNamespace("ggplot2", quietly = TRUE)) {
  install.packages("ggplot2")
}
library(ggplot2)

# Tomemos 'budget' como ejemplo
budget_data <- datos$budget

# Crear histograma
hist_plot <- ggplot(data.frame(x = budget_data), aes(x = x)) +
  geom_histogram(binwidth = 50000000, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de Budget",
       x = "Budget",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = budget_data), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de Budget",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```

### revenue

```{r movies}
library(ggplot2)

# Tomemos 'revenue' como ejemplo
revenue_data <- datos$revenue

# Crear histograma
hist_plot <- ggplot(data.frame(x = revenue_data), aes(x = x)) +
  geom_histogram(binwidth = 50000000, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de revenue",
       x = "revenue",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = revenue_data), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de revenue",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```

### runtime

```{r movies}
library(ggplot2)

# Tomemos 'runtime' como ejemplo
runtime_data <- datos$runtime

# Crear histograma
hist_plot <- ggplot(data.frame(x = runtime_data), aes(x = x)) +
  geom_histogram(binwidth = 10, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de runtime",
       x = "runtime",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = runtime_data), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de runtime",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```

### actorsPopularity

Debido a como vienen los valores es imposible generar un hisograma y un grfico qq por lo que este no se muestra

### popularity

```{r movies}
library(ggplot2)

# Tomemos 'popularity' como ejemplo
popularity_data <- datos$popularity

# Crear histograma
hist_plot <- ggplot(data.frame(x = popularity_data), aes(x = x)) +
  geom_histogram(binwidth = 50, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de popularity",
       x = "popularity",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = popularity_data), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de popularity",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```

### voteAvg

```{r movies}
library(ggplot2)

# Tomemos 'voteAvg' como ejemplo
voteAvg_data <- datos$voteAvg

# Crear histograma
hist_plot <- ggplot(data.frame(x = voteAvg_data), aes(x = x)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de voteAvg",
       x = "voteAvg",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = voteAvg_data), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de voteAvg",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```

### voteCount

```{r movies}
library(ggplot2)

# Tomemos 'voteCount' como ejemplo
voteCount_data <- datos$voteCount

# Crear histograma
hist_plot <- ggplot(data.frame(x = voteCount_data), aes(x = x)) +
  geom_histogram(binwidth = 50, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de voteCount",
       x = "voteCount",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = voteCount_data), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de voteCount",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```

### genresAmount

```{r movies}
library(ggplot2)

# Tomemos 'genresAmount' como ejemplo
genresAmount_data <- datos$genresAmount

# Crear histograma
hist_plot <- ggplot(data.frame(x = genresAmount_data), aes(x = x)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de genresAmount",
       x = "genresAmount",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = genresAmount_data), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de genresAmount",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```

### productionCoAmount

```{r movies}
library(ggplot2)

# Tomemos 'productionCoAmount' como ejemplo
productionCoAmount_data <- datos$productionCoAmount

# Crear histograma
hist_plot <- ggplot(data.frame(x = productionCoAmount_data), aes(x = x)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de productionCoAmount",
       x = "productionCoAmount",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = productionCoAmount_data), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de productionCoAmount",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```

### productionCountriesAmount

```{r movies}
library(ggplot2)

productionCountriesAmount_data <- datos$productionCountriesAmount

# Crear histograma
hist_plot <- ggplot(data.frame(x = productionCountriesAmount_data), aes(x = x)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de productionCountriesAmount",
       x = "productionCountriesAmount",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = productionCountriesAmount_data), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de productionCountriesAmount",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```

### actorsAmount

```{r movies}
library(ggplot2)

actorsAmount_data <- datos$actorsAmount

# Crear histograma
hist_plot <- ggplot(data.frame(x = actorsAmount_data ), aes(x = x)) +
  geom_histogram(binwidth = 50000, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de actorsAmount",
       x = "actorsAmount",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = actorsAmount_data ), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de actorsAmount",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```

### castWomenAmount

Debido a como vienen los valores en formato string es imposible generar un hisograma y un gráfico qq por lo que este no se muestra

### castMenAmount

Debido a como vienen los valores en formato string es imposible generar un hisograma y un gráfico qq por lo que este no se muestra

## Parrafo de variables cuantitativas

Respecto a los histogramas de las variables cuantitativas, se observa que muy pocas de ellas sigue una distribución normal y algunos de ellos no son posibles utilizarlos ya que son string

Las variables que si cumplen con una distribución normal son: runtime, voteaverage y genresAmount. En estas variables las que poseen una distribución asimétrica positiva son runtime y genresAmount.

La variable runtime posee una curtosis leptocúrtica, pero las variables voteaverage y genresAmount tienen una curtosis mesocúrtica.

### Genres

```{r movies}
# Crear tabla de frecuencias para la variable "genres"
genres_sep <- strsplit(as.character(datos$genres), "\\|")
genres_sep <- data.frame(genres = unlist(genres_sep))
genres_table <- as.data.frame(table(genres_sep))
colnames(genres_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  genres_table$Valor <- iconv(genres_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(genres_table))
})
```

### productionCompany

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "productionCompany"
productionCompany_sep <- strsplit(as.character(datos$productionCompany), "\\|")
productionCompany_sep <- data.frame(productionCompany = unlist(productionCompany_sep))
productionCompany_table <- as.data.frame(table(productionCompany_sep))
colnames(productionCompany_table) <- c("Valor", "Frecuencia")

# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Filtrar valores que contienen caracteres no deseados
  productionCompany_table <- productionCompany_table[!grepl("<U\\+", productionCompany_table$Valor), ]
  
  # Convertir las cadenas antes de imprimir
  productionCompany_table$Valor <- iconv(productionCompany_table$Valor, to = "UTF-8", sub = "byte")
  
  # Imprimir solo las primeras filas de la tabla
  print(head(productionCompany_table))
})

```

### productionCompanyCountry

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "productionCompanyCountry"
productionCompanyCountry_sep <- strsplit(as.character(datos$productionCompanyCountry), "\\|")
productionCompanyCountry_sep <- data.frame(productionCompanyCountry = unlist(productionCompanyCountry_sep))
productionCompany_table <- as.data.frame(table(productionCompanyCountry_sep))
colnames(productionCompany_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  productionCompany_table$Valor <- iconv(productionCompany_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(productionCompany_table))
})
```

### productionCountry

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "productionCountry"
productionCountry_sep <- strsplit(as.character(datos$productionCountry), "\\|")
productionCountry_sep <- data.frame(productionCountry = unlist(productionCountry_sep))
productionCountry_table <- as.data.frame(table(productionCountry_sep))
colnames(productionCountry_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  productionCountry_table$Valor <- iconv(productionCountry_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(productionCountry_table))
})
```

### video

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "video"
video_sep <- strsplit(as.character(datos$video), "\\|")
video_sep <- data.frame(video = unlist(video_sep))
video_table <- as.data.frame(table(video_sep))
colnames(video_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  video_table$Valor <- iconv(video_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(video_table))
})
```

### director

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "director"
director_sep <- strsplit(as.character(datos$director), "\\|")
director_sep <- data.frame(director = unlist(director_sep))
director_table <- as.data.frame(table(director_sep))
colnames(director_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  director_table$Valor <- iconv(director_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(director_table))
})
```

### actors

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "actors"
actors_sep <- strsplit(as.character(datos$actors), "\\|")
actors_sep <- data.frame(actors = unlist(actors_sep))
actors_table <- as.data.frame(table(actors_sep))
colnames(actors_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  actors_table$Valor <- iconv(actors_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(actors_table))
})
```

### actorsCharacter

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "actorsCharacter"
actorsCharacter_sep <- strsplit(as.character(datos$actorsCharacter), "\\|")
actorsCharacter_sep <- data.frame(actorsCharacter = unlist(actorsCharacter_sep))
actorsCharacter_table <- as.data.frame(table(actorsCharacter_sep))
colnames(actorsCharacter_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  actorsCharacter_table$Valor <- iconv(actorsCharacter_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(actorsCharacter_table))
})
```

### originalTitle

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "originalTitle"
originalTitle_sep <- strsplit(as.character(datos$originalTitle), "\\|")
originalTitle_sep <- data.frame(originalTitle = unlist(originalTitle_sep))
originalTitle_table <- as.data.frame(table(originalTitle_sep))
colnames(originalTitle_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  originalTitle_table$Valor <- iconv(originalTitle_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(originalTitle_table))
})
```

### title

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "title"
title_sep <- strsplit(as.character(datos$title), "\\|")
title_sep <- data.frame(title = unlist(title_sep))
title_table <- as.data.frame(table(title_sep))
colnames(title_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  title_table$Valor <- iconv(title_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(title_table))
})
```

### originalLanguage

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "originalLanguage"
originalLanguage_sep <- strsplit(as.character(datos$originalLanguage), "\\|")
originalLanguage_sep <- data.frame(originalLanguage = unlist(originalLanguage_sep))
originalLanguage_table <- as.data.frame(table(originalLanguage_sep))
colnames(originalLanguage_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  originalLanguage_table$Valor <- iconv(originalLanguage_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(originalLanguage_table))
})
```

### releaseDate

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "releaseDate"
releaseDate_sep <- strsplit(as.character(datos$releaseDate), "\\|")
releaseDate_sep <- data.frame(releaseDate = unlist(releaseDate_sep))
releaseDate_table <- as.data.frame(table(releaseDate_sep))
colnames(releaseDate_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  releaseDate_table$Valor <- iconv(releaseDate_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(releaseDate_table))
})
```

## Parrafo de variables cualitativas

En estas variables evidenciamos que poseemos variables las cuales al poseer la mayoria frecuencias de 1 no vale mucho la pena poseerlas, a pesar de ello se graficáron pero no eran relevantes ya que, como en las fechas, estas normalmente cada una de ellas tiene una frecuencia muy baja

## 4.Responda las siguientes preguntas:

### 4.1 ¿Cuáles son las 10 películas que contaron con más presupuesto?

```{r movies}
# Instalar y cargar el paquete dplyr si aún no está instalado
if (!requireNamespace("dplyr", quietly = TRUE)) {
  install.packages("dplyr")
}

library(dplyr)

# Seleccionar las primeras 10 filas
top_10_presupuesto <- head(dplyr::arrange(datos, desc(budget)), 10)

# Imprimir el resultado
print(top_10_presupuesto[, c("title", "budget")])

for (i in 1:10) {
  cat("Película:", top_10_presupuesto$title[i], "\t Budget:", top_10_presupuesto$budget[i], "\n")
}

```

### 4.2 ¿Cuáles son las 10 películas que más ingresos tuvieron?

```{r movies}

# Seleccionar las primeras 10 filas
top_10_ingresos <- head(datos[order(-datos$revenue), ], 10)

# Imprimir el resultado
print(top_10_ingresos[, c("title", "revenue")])
cat("\nTop 10 Películas con Mayor Ingreso:\n")
for (i in 1:10) {
  cat("Película:", top_10_ingresos$title[i], "\tIngreso:", top_10_ingresos$revenue[i], "\n")
}
```

### 4.3 ¿Cuál es la película que más votos tuvo?

```{r movies}

# Seleccionar las primeras 10 filas
top_voteCount <- head(datos[order(-datos$voteCount), ], 1)

# Imprimir el resultado
print(top_voteCount[, c("title", "voteCount")])
```

### 4.4 ¿Cuál es la peor película de acuerdo a los votos de todos los usuarios?

```{r movies}
# Seleccionar la película con la peor calificación (voto promedio)
worst_voteAvg <- datos[which.min(datos$voteAvg), c("title", "voteAvg")]

# Imprimir el resultado
cat("La película con la peor calificación es:", worst_voteAvg$title, "con un voto promedio de:", worst_voteAvg$voteAvg, "\n")
```

### 4.5 ¿Cuántas películas se hicieron en cada año? ¿En qué año se hicieron más películas? Haga un gráfico de barras

```{r movies}
# Suponiendo que releaseDate es una cadena en el formato "YYYY-MM-DD"
datos$releaseYear <- as.numeric(format(as.Date(datos$releaseDate), "%Y"))

# Crear tabla con el número de películas por año
peliculas_por_ano <- table(datos$releaseYear)

# Encontrar el año con más películas
ano_mas_peliculas <- names(peliculas_por_ano[which.max(peliculas_por_ano)])

# Imprimir el número de películas por año
cat("Número de películas por año:\n")
print(peliculas_por_ano)

# Imprimir en qué año se hicieron más películas
cat("\nEn el año", ano_mas_peliculas, "se hicieron más películas.\n")

# Crear gráfico de barras
barplot(peliculas_por_ano, main = "Número de Películas por Año", xlab = "Año", ylab = "Número de Películas")

```

### 4.6 ¿Cuál es el género principal de las 20 películas más recientes? ¿Cuál es el género principal que predomina en el conjunto de datos? Represéntelo usando un gráfico

```{r movies}
# Suponiendo que releaseDate es una cadena en el formato "YYYY-MM-DD"
datos$releaseYear <- as.numeric(format(as.Date(datos$releaseDate), "%Y"))

# Ordenar las películas por fecha de lanzamiento de manera descendente
datos_ordenados <- datos[order(-datos$releaseYear), ]

# Seleccionar las 20 películas más recientes
top_20_recientes <- head(datos_ordenados, 20)

# Obtener el género principal de las 20 películas más recientes
genero_principal_top_20 <- table(unlist(strsplit(top_20_recientes$genres, "\\|")))

# Obtener el género principal que predomina en el conjunto de datos
genero_principal_total <- table(unlist(strsplit(datos$genres, "\\|")))

# Encontrar el género principal más común
genero_principal_mas_comun <- names(genero_principal_total[which.max(genero_principal_total)])

# Crear gráfico de barras para el género principal de las 20 películas más recientes
barplot(genero_principal_top_20, main = "Género Principal de las 20 Películas Más Recientes", xlab = "Género", ylab = "Número de Películas")

# Imprimir el género principal de las 20 películas más recientes
cat("\nGénero Principal de las 20 Películas Más Recientes:\n")
print(genero_principal_top_20)

# Imprimir el género principal que predomina en el conjunto de datos
cat("\nGénero Principal que Predomina en el Conjunto de Datos:\n")
print(genero_principal_mas_comun)
```

### 4.7 ¿Las películas de qué genero principal obtuvieron mayores ganancias?

### 4.8 ¿La cantidad de actores influye en los ingresos de las películas?¿se han hecho películas con más actores en los últimos años?

### 4.9 ¿Es posible que la cantidad de hombres y mujeres en el reparto influya en la popularidad y los ingresos de las películas?

### 4.10 ¿Quiénes son los directores que hicieron las 20 películas mejor calificadas?

### 4.11 ¿Cómo se correlacionan los presupuestos con los ingresos? ¿Los altos presupuestos significan altos ingresos? Haga los gráficos que necesite, histograma, diagrama de dispersión

### 4.12 ¿Se asocian ciertos meses de lanzamiento con mejores ingresos?

### 4.13 ¿En qué meses se han visto los lanzamientos con mejores ingresos?¿cuantas películas, en promedio, se han lanzado por mes?

### 4.14 ¿Cómo se correlacionan las calificaciones con el éxito comercial?
```{r movies}
# Seleccionar las primeras 10 filas con los campos 'title', 'revenue', 'voteAvg'
top_10_revenue <- head(datos[order(-datos$revenue), c("title", "revenue", "voteAvg")], 15)

# Calcular la correlación entre las calificaciones y los ingresos
correlation <- cor(top_10_revenue$voteAvg, top_10_revenue$revenue)

# Graficar la relación entre calificaciones y ingresos con la correlación
ggplot(top_10_revenue, aes(x = voteAvg, y = revenue)) +
  geom_point() +
  geom_text(aes(label = paste("Correlación:", round(correlation, 2)), x = max(voteAvg), y = max(revenue)), vjust = 1, hjust = 1) +
  labs(title = "Relación entre Calificaciones y Ingresos",
       x = "Calificación Promedio",
       y = "Ingresos")
```

### 4.15 ¿A qué género principal pertenecen las películas más largas?
```{r movies}
# Cargar la librería ggplot2
if (!requireNamespace("ggplot2", quietly = TRUE)) {
  install.packages("ggplot2")
}
library(ggplot2)

# Cargar la librería dplyr
if (!requireNamespace("dplyr", quietly = TRUE)) {
  install.packages("dplyr")
}
library(dplyr)

# Cargar la librería stringr
if (!requireNamespace("stringr", quietly = TRUE)) {
  install.packages("stringr")
}
library(stringr)

# Seleccionar las primeras 10 filas con los campos 'title' y 'genre'
top_10_runtime <- head(datos[order(-datos$runtime), c("title", "genres")], 15)

# Contar la frecuencia de cada género
genre_counts <- top_10_runtime %>%
  mutate(first_genre = str_extract(genres, "^[^|]+")) %>%
  count(first_genre) %>%
  arrange(desc(n))


print(genre_counts)
```

### 5.1 Cómo se distribuye la duración de las peliculas

```{r movies}
# Crear histograma
hist(datos$runtime, main = "Distribución de Duraciones de Películas", xlab = "Duración en min", ylab = "Frecuencia", col = "skyblue", border = "black")


```

### 5.2 Existe una relación entre la popularidad y las votaciones
```{r movies}
# Crear diagrama de dispersión
plot(datos$popularity, datos$voteAvg, main = "Relación entre Popularidad y Votaciones", xlab = "Popularidad", ylab = "Votación", pch = 16, col = "darkgreen")
```

### 5.3 Cual es la proporción de películas con y sin video disponible
```{r movies}
# Crear gráfico de pastel
pie(table(datos$video), main = "Proporción de Películas con Video Disponible", col = c("lightgreen", "lightpink"))
```

### 5.4 

``` {r movies}
```
