---
title: "MD-HT1"
output: html_document
date: "2024-01-25"
repo: https://github.com/TheDeloz-v2/MD-HT1.git 
---

## Carga de datos

```{r setup, include=FALSE}
datos <- read.csv("movies.csv")
```

## 1. Resumen de nuestro conjunto de datos

```{r movies}
summary(datos)
```

## 2. Diga el tipo de cada una de las variables (cualitativa ordinal o nominal, cuantitativa continua, cuantitativa discreta)

```{r movies}
if (!requireNamespace("knitr", quietly = TRUE)) {
  install.packages("knitr")
}

library(knitr)
# Definir manualmente los tipos de variables que son cada una
tipo <- c("Cuantitativa discreta", "Cuantitativa continua", "Cualitativa nominal",
                    "Cualitativa nominal", "Cualitativa nominal", "Cualitativa nominal",
                    "Cualitativa nominal", "Cuantitativa continua",
                    "Cuantitativa continua", "Cualitativa nominal", "Cualitativa nominal",
                    "Cualitativa nominal", "Cuantitativa continua", "Cualitativa nominal",
                    "Cualitativa nominal", "Cualitativa nominal", "Cualitativa nominal",
                    "Cuantitativa continua", "Cualitativa nominal", "Cuantitativa continua",
                    "Cuantitativa discreta", "Cuantitativa discreta", "Cuantitativa discreta",
                    "Cuantitativa discreta", "Cuantitativa discreta", "Cuantitativa discreta",
                    "Cuantitativa discreta")

# Crear un dataframe con los nombres de las columnas y los tipos que son
tabla_columnas_valores <- data.frame(Variables = colnames(datos), TipoVariable = tipo)

# Imprimir la tabla usando kable()
kable(tabla_columnas_valores, format = "html", row.names = TRUE)
```

## 3. Investigue si las variables cuantitativas siguen una distribución normal y haga una tabla de frecuencias de las variables cualitativas. Explique todos los resultados.

### budget

```{r movies}
# Descargamos ggplot2
if (!requireNamespace("ggplot2", quietly = TRUE)) {
  install.packages("ggplot2")
}
library(ggplot2)

# Tomemos 'budget' como ejemplo
budget_data <- datos$budget

# Crear histograma
hist_plot <- ggplot(data.frame(x = budget_data), aes(x = x)) +
  geom_histogram(binwidth = 50000000, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de Budget",
       x = "Budget",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = budget_data), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de Budget",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```

### revenue

```{r movies}
library(ggplot2)

# Tomemos 'revenue' como ejemplo
revenue_data <- datos$revenue

# Crear histograma
hist_plot <- ggplot(data.frame(x = revenue_data), aes(x = x)) +
  geom_histogram(binwidth = 50000000, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de revenue",
       x = "revenue",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = revenue_data), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de revenue",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```

### runtime

```{r movies}
library(ggplot2)

# Tomemos 'runtime' como ejemplo
runtime_data <- datos$runtime

# Crear histograma
hist_plot <- ggplot(data.frame(x = runtime_data), aes(x = x)) +
  geom_histogram(binwidth = 10, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de runtime",
       x = "runtime",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = runtime_data), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de runtime",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```

### actorsPopularity

Debido a como vienen los valores es imposible generar un hisograma y un grfico qq por lo que este no se muestra

### popularity

```{r movies}
library(ggplot2)

# Tomemos 'popularity' como ejemplo
popularity_data <- datos$popularity

# Crear histograma
hist_plot <- ggplot(data.frame(x = popularity_data), aes(x = x)) +
  geom_histogram(binwidth = 50, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de popularity",
       x = "popularity",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = popularity_data), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de popularity",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```

### voteAvg

```{r movies}
library(ggplot2)

# Tomemos 'voteAvg' como ejemplo
voteAvg_data <- datos$voteAvg

# Crear histograma
hist_plot <- ggplot(data.frame(x = voteAvg_data), aes(x = x)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de voteAvg",
       x = "voteAvg",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = voteAvg_data), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de voteAvg",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```

### voteCount

```{r movies}
library(ggplot2)

# Tomemos 'voteCount' como ejemplo
voteCount_data <- datos$voteCount

# Crear histograma
hist_plot <- ggplot(data.frame(x = voteCount_data), aes(x = x)) +
  geom_histogram(binwidth = 50, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de voteCount",
       x = "voteCount",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = voteCount_data), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de voteCount",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```

### genresAmount

```{r movies}
library(ggplot2)

# Tomemos 'genresAmount' como ejemplo
genresAmount_data <- datos$genresAmount

# Crear histograma
hist_plot <- ggplot(data.frame(x = genresAmount_data), aes(x = x)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de genresAmount",
       x = "genresAmount",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = genresAmount_data), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de genresAmount",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```

### productionCoAmount

```{r movies}
library(ggplot2)

# Tomemos 'productionCoAmount' como ejemplo
productionCoAmount_data <- datos$productionCoAmount

# Crear histograma
hist_plot <- ggplot(data.frame(x = productionCoAmount_data), aes(x = x)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de productionCoAmount",
       x = "productionCoAmount",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = productionCoAmount_data), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de productionCoAmount",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```

### productionCountriesAmount

```{r movies}
library(ggplot2)

productionCountriesAmount_data <- datos$productionCountriesAmount

# Crear histograma
hist_plot <- ggplot(data.frame(x = productionCountriesAmount_data), aes(x = x)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de productionCountriesAmount",
       x = "productionCountriesAmount",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = productionCountriesAmount_data), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de productionCountriesAmount",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```

### actorsAmount

```{r movies}
library(ggplot2)

actorsAmount_data <- datos$actorsAmount

# Crear histograma
hist_plot <- ggplot(data.frame(x = actorsAmount_data ), aes(x = x)) +
  geom_histogram(binwidth = 50000, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de actorsAmount",
       x = "actorsAmount",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = actorsAmount_data ), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de actorsAmount",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```

### castWomenAmount

Debido a como vienen los valores en formato string es imposible generar un hisograma y un gráfico qq por lo que este no se muestra

### castMenAmount

Debido a como vienen los valores en formato string es imposible generar un hisograma y un gráfico qq por lo que este no se muestra

## Parrafo de variables cuantitativas

Respecto a los histogramas de las variables cuantitativas, se observa que muy pocas de ellas sigue una distribución normal y algunos de ellos no son posibles utilizarlos ya que son string

Las variables que si cumplen con una distribución normal son: runtime, voteaverage y genresAmount. En estas variables las que poseen una distribución asimétrica positiva son runtime y genresAmount.

La variable runtime posee una curtosis leptocúrtica, pero las variables voteaverage y genresAmount tienen una curtosis mesocúrtica.

### Genres

```{r movies}
# Crear tabla de frecuencias para la variable "genres"
genres_sep <- strsplit(as.character(datos$genres), "\\|")
genres_sep <- data.frame(genres = unlist(genres_sep))
genres_table <- as.data.frame(table(genres_sep))
colnames(genres_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  genres_table$Valor <- iconv(genres_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(genres_table))
})
```

### productionCompany

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "productionCompany"
productionCompany_sep <- strsplit(as.character(datos$productionCompany), "\\|")
productionCompany_sep <- data.frame(productionCompany = unlist(productionCompany_sep))
productionCompany_table <- as.data.frame(table(productionCompany_sep))
colnames(productionCompany_table) <- c("Valor", "Frecuencia")

# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Filtrar valores que contienen caracteres no deseados
  productionCompany_table <- productionCompany_table[!grepl("<U\\+", productionCompany_table$Valor), ]
  
  # Convertir las cadenas antes de imprimir
  productionCompany_table$Valor <- iconv(productionCompany_table$Valor, to = "UTF-8", sub = "byte")
  
  # Imprimir solo las primeras filas de la tabla
  print(head(productionCompany_table))
})

```

### productionCompanyCountry

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "productionCompanyCountry"
productionCompanyCountry_sep <- strsplit(as.character(datos$productionCompanyCountry), "\\|")
productionCompanyCountry_sep <- data.frame(productionCompanyCountry = unlist(productionCompanyCountry_sep))
productionCompany_table <- as.data.frame(table(productionCompanyCountry_sep))
colnames(productionCompany_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  productionCompany_table$Valor <- iconv(productionCompany_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(productionCompany_table))
})
```

### productionCountry

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "productionCountry"
productionCountry_sep <- strsplit(as.character(datos$productionCountry), "\\|")
productionCountry_sep <- data.frame(productionCountry = unlist(productionCountry_sep))
productionCountry_table <- as.data.frame(table(productionCountry_sep))
colnames(productionCountry_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  productionCountry_table$Valor <- iconv(productionCountry_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(productionCountry_table))
})
```

### video

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "video"
video_sep <- strsplit(as.character(datos$video), "\\|")
video_sep <- data.frame(video = unlist(video_sep))
video_table <- as.data.frame(table(video_sep))
colnames(video_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  video_table$Valor <- iconv(video_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(video_table))
})
```

### director

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "director"
director_sep <- strsplit(as.character(datos$director), "\\|")
director_sep <- data.frame(director = unlist(director_sep))
director_table <- as.data.frame(table(director_sep))
colnames(director_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  director_table$Valor <- iconv(director_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(director_table))
})
```

### actors

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "actors"
actors_sep <- strsplit(as.character(datos$actors), "\\|")
actors_sep <- data.frame(actors = unlist(actors_sep))
actors_table <- as.data.frame(table(actors_sep))
colnames(actors_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  actors_table$Valor <- iconv(actors_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(actors_table))
})
```

### actorsCharacter

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "actorsCharacter"
actorsCharacter_sep <- strsplit(as.character(datos$actorsCharacter), "\\|")
actorsCharacter_sep <- data.frame(actorsCharacter = unlist(actorsCharacter_sep))
actorsCharacter_table <- as.data.frame(table(actorsCharacter_sep))
colnames(actorsCharacter_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  actorsCharacter_table$Valor <- iconv(actorsCharacter_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(actorsCharacter_table))
})
```

### originalTitle

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "originalTitle"
originalTitle_sep <- strsplit(as.character(datos$originalTitle), "\\|")
originalTitle_sep <- data.frame(originalTitle = unlist(originalTitle_sep))
originalTitle_table <- as.data.frame(table(originalTitle_sep))
colnames(originalTitle_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  originalTitle_table$Valor <- iconv(originalTitle_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(originalTitle_table))
})
```

### title

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "title"
title_sep <- strsplit(as.character(datos$title), "\\|")
title_sep <- data.frame(title = unlist(title_sep))
title_table <- as.data.frame(table(title_sep))
colnames(title_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  title_table$Valor <- iconv(title_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(title_table))
})
```

### originalLanguage

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "originalLanguage"
originalLanguage_sep <- strsplit(as.character(datos$originalLanguage), "\\|")
originalLanguage_sep <- data.frame(originalLanguage = unlist(originalLanguage_sep))
originalLanguage_table <- as.data.frame(table(originalLanguage_sep))
colnames(originalLanguage_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  originalLanguage_table$Valor <- iconv(originalLanguage_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(originalLanguage_table))
})
```

### releaseDate

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "releaseDate"
releaseDate_sep <- strsplit(as.character(datos$releaseDate), "\\|")
releaseDate_sep <- data.frame(releaseDate = unlist(releaseDate_sep))
releaseDate_table <- as.data.frame(table(releaseDate_sep))
colnames(releaseDate_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  releaseDate_table$Valor <- iconv(releaseDate_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(releaseDate_table))
})
```

## Parrafo de variables cualitativas

En estas variables evidenciamos que poseemos variables las cuales al poseer la mayoria frecuencias de 1 no vale mucho la pena poseerlas, a pesar de ello se graficáron pero no eran relevantes ya que, como en las fechas, estas normalmente cada una de ellas tiene una frecuencia muy baja

## 4.Responda las siguientes preguntas:

### 4.1 ¿Cuáles son las 10 películas que contaron con más presupuesto?

```{r movies}
# Instalar y cargar el paquete dplyr si aún no está instalado
if (!requireNamespace("dplyr", quietly = TRUE)) {
  install.packages("dplyr")
}

library(dplyr)

# Seleccionar las primeras 10 filas
top_10_presupuesto <- head(dplyr::arrange(datos, desc(budget)), 10)

# Imprimir el resultado
print(top_10_presupuesto[, c("title", "budget")])

for (i in 1:10) {
  cat("Película:", top_10_presupuesto$title[i], "\t Budget:", top_10_presupuesto$budget[i], "\n")
}

```

### 4.2 ¿Cuáles son las 10 películas que más ingresos tuvieron?

```{r movies}

# Seleccionar las primeras 10 filas
top_10_ingresos <- head(datos[order(-datos$revenue), ], 10)

# Imprimir el resultado
print(top_10_ingresos[, c("title", "revenue")])
cat("\nTop 10 Películas con Mayor Ingreso:\n")
for (i in 1:10) {
  cat("Película:", top_10_ingresos$title[i], "\tIngreso:", top_10_ingresos$revenue[i], "\n")
}
```

### 4.3 ¿Cuál es la película que más votos tuvo?

```{r movies}

# Seleccionar las primeras 10 filas
top_voteCount <- head(datos[order(-datos$voteCount), ], 1)

# Imprimir el resultado
print(top_voteCount[, c("title", "voteCount")])
```

### 4.4 ¿Cuál es la peor película de acuerdo a los votos de todos los usuarios?

```{r movies}
# Seleccionar la película con la peor calificación (voto promedio)
worst_voteAvg <- datos[which.min(datos$voteAvg), c("title", "voteAvg")]

# Imprimir el resultado
cat("La película con la peor calificación es:", worst_voteAvg$title, "con un voto promedio de:", worst_voteAvg$voteAvg, "\n")
```

### 4.5 ¿Cuántas películas se hicieron en cada año? ¿En qué año se hicieron más películas? Haga un gráfico de barras

```{r movies}
# Suponiendo que releaseDate es una cadena en el formato "YYYY-MM-DD"
datos$releaseYear <- as.numeric(format(as.Date(datos$releaseDate), "%Y"))

# Crear tabla con el número de películas por año
peliculas_por_ano <- table(datos$releaseYear)

# Encontrar el año con más películas
ano_mas_peliculas <- names(peliculas_por_ano[which.max(peliculas_por_ano)])

# Imprimir el número de películas por año
cat("Número de películas por año:\n")
print(peliculas_por_ano)

# Imprimir en qué año se hicieron más películas
cat("\nEn el año", ano_mas_peliculas, "se hicieron más películas.\n")

# Crear gráfico de barras
barplot(peliculas_por_ano, main = "Número de Películas por Año", xlab = "Año", ylab = "Número de Películas")

```
En el año 2021 se hicieron más películas. con un total de 816. Se nota que hay un crecimiento exponencial ya que entre más pasa el tiempo se realizan más peliculas

### 4.6 ¿Cuál es el género principal de las 20 películas más recientes? ¿Cuál es el género principal que predomina en el conjunto de datos? Represéntelo usando un gráfico

```{r movies}
# Suponiendo que releaseDate es una cadena en el formato "YYYY-MM-DD"
datos$releaseYear <- as.numeric(format(as.Date(datos$releaseDate), "%Y"))

# Ordenar las películas por fecha de lanzamiento de manera descendente
datos_ordenados <- datos[order(-datos$releaseYear), ]

# Seleccionar las 20 películas más recientes
top_20_recientes <- head(datos_ordenados, 20)

# Obtener el género principal de las 20 películas más recientes
genero_principal_top_20 <- table(unlist(strsplit(top_20_recientes$genres, "\\|")))

# Obtener el género principal que predomina en el conjunto de datos
genero_principal_total <- table(unlist(strsplit(datos$genres, "\\|")))

# Encontrar el género principal más común
genero_principal_mas_comun <- names(genero_principal_total[which.max(genero_principal_total)])

# Crear gráfico de barras para el género principal de las 20 películas más recientes
barplot(genero_principal_top_20, main = "Género Principal de las 20 Películas Más Recientes", xlab = "Género", ylab = "Número de Películas")

# Imprimir el género principal de las 20 películas más recientes
cat("\nGénero Principal de las 20 Películas Más Recientes:\n")
print(genero_principal_top_20)

# Imprimir el género principal que predomina en el conjunto de datos
cat("\nGénero Principal que Predomina en el Conjunto de Datos:\n")
print(genero_principal_mas_comun)
```

El género principal de las 20 películas es Drama seguido de Comedia y acción


### 4.7 ¿Las películas de qué genero principal obtuvieron mayores ganancias?
```{r movies}
# Seleccionar las primeras 10 filas con los campos 'title' y 'genre'
top_10_revenue <- head(datos[order(-datos$revenue), c("title", "genres")], 15)

# Contar la frecuencia de cada género
genre_counts <- top_10_revenue   %>%
  mutate(first_genre = str_extract(genres, "^[^|]+")) %>%
  count(first_genre) %>%
  arrange(desc(n))


print(genre_counts)
```

Interpretando la pregunta como el conteo de los géneros de las películas con mayores
ingresos, las de acción son las lideran el conteo con un total de 7, seguidas de las
de aventura con 3, ciencia ficción con 2 y tanto drama, familia y fantasía con 1.

```{r movies}
# Seleccionar las primeras 10 filas
top_10_revenue <- head(datos[order(-datos$revenue), c("title", "genres", "revenue")], 100)

# Seleccionar las películas con mayor "revenue" por género
top_by_genre <- top_10_revenue %>%
  group_by(first_genre = str_extract(genres, "^[^|]+")) %>%
  top_n(1, revenue) %>%
  ungroup()

# Contar la frecuencia de cada género
genre_counts <- top_by_genre %>%
  count(first_genre, top_title = title, revenue=revenue) %>%
  arrange(desc(revenue))

print(genre_counts)

```

Interpretando la pregunta como obtener de cada género la película con mayor ingreso, 
esta tabla muestra los resultados. Es notable que entre los primeros puestos no 
existe una gran diferencia, por lo que es posible decir que al menos los 8 primeros 
puestos pertenecen también a los puestos del top ingresos globales.

### 4.8 ¿La cantidad de actores influye en los ingresos de las películas?¿se han hecho películas con más actores en los últimos años?
```{r movies}
# Obtener el top 100 de peliculas con más cantidad de actores
actorAmount <- head(datos[order(-datos$actorsAmount), c("title", "actorsAmount", "revenue")], 100)

# Filtrar los datos para quitar las observaciones con revenue vacía o igual a 0
actorAmount_filtrados <- actorAmount %>%
  filter(!is.na(revenue) & revenue != 0) %>%
  slice(3:n())

# Imprimir los datos filtrados
print(actorAmount_filtrados)
```

```{r movies}

# Calcular la correlación entre cantidad de actores y los ingresos
correlation <- cor(actorAmount_filtrados$actorsAmount, actorAmount_filtrados$revenue)
correlation

# Diagrama de dispersión entre cantidad de actores y los ingresos
ggplot(actorAmount_filtrados, aes(x = actorsAmount, y = revenue)) +
  geom_point(alpha = 0.6) +
  labs(title = "Diagrama de Dispersión entre Cantidad de Actores y los Ingresos", label = paste("Correlación:", round(correlation, 2)),
       x = "Cantidad de Actores",
       y = "Ingresos") +
  theme_minimal()

```

Como tal, según nuestro diagrama de dispersión y el índice de correlación entre 
la cantidad de actores y los ingresos de las películas, no existe como tal una 
relación entre estas variables, por lo que la cantidad de actores no influye en 
los ingresos de las películas.

```{r movies}

datos <- read.csv("movies.csv")

# Suponiendo que releaseDate es una cadena en el formato "YYYY-MM-DD"
datos$releaseYear <- as.numeric(format(as.Date(datos$releaseDate), "%Y"))

# Calcular la media de actores por película para cada año
media_actores_por_año <- aggregate(actorsAmount ~ releaseYear, data = datos, FUN = mean)

# Crear una gráfica de barras
barplot(media_actores_por_año$actorsAmount, names.arg = media_actores_por_año$releaseYear, 
        main = "Media de Actores por Película por Año", xlab = "Año", ylab = "Media de Actores por Película")

```

Según el gráfico, se observa que a partir de aproximadamente el año 2000 
se han hecho películas con más actores que antes, sin embargo, no es un 
crecimiento constante, ya que a partir de ahí han habido años con más o menos
cantidad sin mostrar ningún patrón aparente.

### 4.9 ¿Es posible que la cantidad de hombres y mujeres en el reparto influya en la popularidad y los ingresos de las películas?
```{r movies}

datos <- read.csv("movies.csv")

# Cantidad de actores
datos$castMenTotal <- as.integer(datos$castMenAmount)

# Cantidad de actrices
datos$castWomenTotal <- as.integer(datos$castWomenAmount)

# Omitir los datos NA
datos <- na.omit(datos[, c("popularity", "revenue", "castMenTotal", "castWomenTotal")])

# Calcular las correlaciones
correlationPopularityWomen <- cor(datos$popularity, datos$castWomenTotal)
correlationPopularityMen <- cor(datos$popularity, datos$castMenTotal)
correlationRevenueWomen <- cor(datos$revenue, datos$castWomenTotal)
correlationRevenueMen <- cor(datos$revenue, datos$castMenTotal)

cat("\nCorrelacion entre popularidad y la cantidad de mujeres en el reparto:")
print(correlationPopularityWomen)
cat("\nCorrelacion entre los ingresos  y la cantidad de mujeres en el reparto:")
print(correlationPopularityMen)
cat("\nCorrelacion entre popularidad y la cantidad de hombres en el reparto:")
print(correlationRevenueWomen)
cat("\nCorrelacion entre los ingresos y la cantidad de hombres en el reparto:")
print(correlationRevenueMen)
```

Según los valores de las correlaciones, ninguna de es lo suficientemente alta 
como para indicar algún tipo de relación o influencia entre la cantidad de los 
actores y actrices con la popularidad e ingresos de las películas.


### 4.10 ¿Quiénes son los directores que hicieron las 20 películas mejor calificadas?
```{r movies}

# Seleccionar las primeras 20 filas segun la calificacion promedio de la pelicula
top_10_rating <- head(datos[order(-datos$voteAvg), c("title", "voteAvg", "director")], 20)

# Filtrar las películas para quitar aquellas que no tienen registro de director
top_10_rating <- top_10_rating %>%
  filter(!is.na(director) & director != "")

print(top_10_rating)
```

En la tabla generada se muestran los directores de las 20 películas mejor calificadas.


### 4.11 ¿Cómo se correlacionan los presupuestos con los ingresos? ¿Los altos presupuestos significan altos ingresos? Haga los gráficos que necesite, histograma, diagrama de dispersión
```{r movies}
# Calcular la correlación entre presupuestos y ingresos
correlation <- cor(datos$budget, datos$revenue)
correlation

# Diagrama de dispersión entre presupuestos y ingresos
ggplot(datos, aes(x = budget, y = revenue)) +
  geom_point(alpha = 0.6) +
  labs(title = "Diagrama de Dispersión entre Presupuestos y Ingresos", label = paste("Correlación:", round(correlation, 2)),
       x = "Presupuesto",
       y = "Ingresos") +
  theme_minimal()
```

Es diagrama de dispersión generado muestra que efectivamente, existe una relación 
entre la cantidad de presupuesto y los ingresos. A mayor presupuesto es esperable
una mayor recaudación y viceversa. Esto se ve corroborado por el índice de 
correlación generado, pues este siendo 0.76 se mantiene dentro de un rango donde
es aceptable indicar correlación.

### 4.12 ¿Se asocian ciertos meses de lanzamiento con mejores ingresos?
```{r movies}

# Convertir la fecha de lanzamiento a formato de fecha y extraer el mes
datos$releaseMonth <- as.numeric(format(as.Date(datos$releaseDate), "%m"))

# Calcular el promedio de ingresos por mes
ingresos_promedio_por_mes <- aggregate(revenue ~ releaseMonth, data = datos, FUN = mean)

# Crear gráfico de barras
ggplot(ingresos_promedio_por_mes, aes(x = factor(releaseMonth), y = revenue)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(title = "Ingresos Promedio por Mes de Lanzamiento",
       x = "Mes de Lanzamiento",
       y = "Ingresos Promedio")

```

Los meses de mayo, junio y julio son los meses que han tenido la mayor cantidad promedio
de ingresos, estos seguidos de diciembre y noviembre. Esto puede indicar que existe una
relación entre la época de estreno y la cantidad de recaudación, pues precisamente todos
estos meses pueden considerarse como vacacionales.

Los meses con menor promedio de ingresos son septiembre, enero, agosto y octubre.

### 4.13 ¿En qué meses se han visto los lanzamientos con mejores ingresos? ¿cuantas películas, en promedio, se han lanzado por mes?
```{r movies}
# Convertir la fecha de lanzamiento a formato de fecha y extraer el mes
datos$releaseMonth <- as.numeric(format(as.Date(datos$releaseDate), "%m"))

# Seleccionar las primeras 20 filas de las peliculas con mejores ingresos
top_20_revenue <- head(datos[order(-datos$revenue), c("title", "revenue", "releaseMonth")], 20)

# Contar la frecuencia de lanzamientos por mes
conteo_por_mes <- table(top_20_revenue$releaseMonth)

# Crear gráfico de barras
barplot(conteo_por_mes, main = "Lanzamientos con Mejores Ingresos por Mes", xlab = "Mes", ylab = "Número de Lanzamientos")

```

Los lanzamientos con mejores ingresos, tomando en cuenta que se toman los primeros 20 puestos, se han visto 
principalmente en el mes de abril, seguido de diciembre, junio y noviembre. Esta grafica también nos muestra 
que ningúna película dentro del top de ingresos se ha estrenado en enero, mayo, agosto, septiembre ni
octubre.

```{r movies}
# Suponiendo que releaseDate es una cadena en el formato "YYYY-MM-DD"
datos$releaseYear <- as.numeric(format(as.Date(datos$releaseDate), "%Y"))

# Suponiendo que releaseDate es una cadena en el formato "YYYY-MM-DD"
datos$releaseMonth <- as.numeric(format(as.Date(datos$releaseDate), "%m"))

# Crear tabla con el número de películas por mes
peliculas_por_mes <- table(datos$releaseMonth)

# Calcular el número total de años en el conjunto de datos
num_anos <- length(unique(datos$releaseYear))

# Calcular el promedio de películas por mes
promedio_peliculas_por_mes <- peliculas_por_mes / num_anos

# Imprimir el promedio de películas por mes
cat("Promedio de películas por mes:\n")
print(promedio_peliculas_por_mes)

# Crear gráfico de barras
barplot(promedio_peliculas_por_mes, main = "Promedio de Películas por Mes", xlab = "Mes", ylab = "Cantidad Promedio de Películas")
```

Esta grafica muestra el promedio de películas estrenadas durante los 12 meses en todos 
los años. Los meses con una mayor cantidad de películas estrenadas son septiembre y
octubre con un promedio de 10 películas.

### 4.14 ¿Cómo se correlacionan las calificaciones con el éxito comercial?
```{r movies}
# Seleccionar las primeras 15 filas con los campos 'title', 'revenue', 'voteAvg'
top_10_revenue <- head(datos[order(-datos$revenue), c("title", "revenue", "voteAvg")], 15)

# Calcular la correlación entre las calificaciones y los ingresos
correlation <- cor(top_10_revenue$voteAvg, top_10_revenue$revenue)

# Graficar la relación entre calificaciones y ingresos con la correlación
ggplot(top_10_revenue, aes(x = voteAvg, y = revenue)) +
  geom_point() +
  geom_text(aes(label = paste("Correlación:", round(correlation, 2)), x = max(voteAvg), y = max(revenue)), vjust = 1, hjust = 1) +
  labs(title = "Relación entre Calificaciones y Ingresos",
       x = "Calificación Promedio",
       y = "Ingresos")
```

### 4.15 ¿A qué género principal pertenecen las películas más largas?
```{r movies}
# Seleccionar las primeras 20 filas con las peliculas mas largas
top_10_runtime <- head(datos[order(-datos$runtime), c("title", "genres")], 20)

# Contar la frecuencia de cada género
genre_counts <- top_10_runtime %>%
  mutate(first_genre = str_extract(genres, "^[^|]+")) %>%
  count(first_genre) %>%
  arrange(desc(n))


print(genre_counts)
```

Entendiendo la pregunta como el conteo del genero principal al que pertenecen las películas con mayor duración, 
dentro de los primeros 20 puestos tenemos que existe un total de 7 películas de drama, 5 películas de acción, 4
películas documentales y una película de comedia, crimen, musical y guerra. Concluyendo entonces que el género
de drama es el que predomina dentro de las 20 películas más largas.


### 5.1 Cómo se distribuye la duración de las peliculas

```{r movies}
# Definir límites deseados para el eje x
limites_x <- c(0, 200)

plot(datos$runtime, datos$revenue, main = "Relación entre Duración y Ventas de Películas", xlab = "Duración en min", ylab = "Ventas", xlim = limites_x)

```

El gráfico de dispersión generado ofrece una perspectiva reveladora sobre la relación entre la duración de las películas y sus ventas en el conjunto de datos. Al observar el gráfico, podemos identificar patrones o tendencias que podrían indicar cómo el rango de 100 a 150 de duración están asociados con niveles bastante altos en las ventas  en la industria cinematográfica. La dispersión de puntos a lo largo de los ejes x e y proporciona una representación visual de la variabilidad en las duraciones de las películas y las ventas asociadas. Los datos revelan que una duración óptima de las películas para tener un mayor margen de ganacias se encuentra entre los 100 a los 150 minutos y como se evidencia la mayoría de las películas se encuentran en este a pesar de no haber tenido ganancias.

### 5.2 Existe una relación entre la popularidad y las votaciones
```{r movies}
# Crear diagrama de dispersión
plot(datos$voteAvg,datos$popularity, main = "Relación entre Popularidad y Votaciones", xlab = "Votación", ylab = "Popularidad", pch = 16, col = "darkgreen")
# Calcular el coeficiente de correlación
correlation <- cor(datos$popularity, datos$voteAvg)

# Imprimir el coeficiente de correlación
print(paste("Coeficiente de correlación:", correlation, " gracias a esto podemos concluir que hay una relación muy débil entre la popularidad y las votaciones"))
```
El gráfico de dispersión generado ofrece una perspectiva reveladora sobre la relación entre la popularidad de las películas y sus punteos en las votacines en el conjunto de datos. Al observar el gráfico, podemos identificar patrones o tendencias que podrían indicar cómo el rango de 5 a 8 de votación están asociados con niveles bastante altos en la popularidad  en la industria cinematográfica.Los datos revelan que si la película es popular y posee un gran público el promedio de los votos es normalmente entre  5 a 8 puntos ya que al tener un público variado este poseera distintas críticas y no permitirá que se tengan notas tan altas como en los puntos donde la popularidad es muy baja y sesga los datos a muy altos o muy bajos debido a la cantidad de público que fue a visualizarla.

### 5.3 Existe alguna relacion entre que exista un video promocional de la pelicula y la popularidad que esta alcanza?
```{r movies}

# Calcular la correlación entre la existencia de un video promocional y la popularidad
correlation <- cor(datos$video, datos$popularity)
correlation

# Calcular la media de popularidad para películas con y sin video promocional
mean_popularity <- aggregate(popularity ~ video, data = datos, FUN = mean)

# Crear un gráfico de barras para comparar la popularidad entre películas con y sin video promocional
ggplot(mean_popularity, aes(x = video, y = popularity, fill = video)) +
  geom_bar(stat = "identity") +
  labs(title = "Comparación de Popularidad con y sin Video Promocional",
       x = "Video Promocional",
       y = "Popularidad Promedio") +
  theme_minimal()


```

Tanto el valor del índice de correlación como el gráfico generado demuestran que 
no existe ningún tipo de relación entre que una película tenga videos promocionales
y la popularidad que posee.

### 5.4 ¿Cuál es la proporción de películas según la cantidad de géneros que posee? ¿Y cuál es la que más tiene?
``` {r movies}
# Seleccionar las primeras 15 filas con los campos 'title', 'revenue', 'voteAvg'
top_10_revenue <- head(datos[order(-datos$genresAmount), c("title", "genresAmount")], 1)
print(top_10_revenue)
```

La película que más géneros tiene es Live Spectale NARUTO -Song of the Akatsuki-
con un total de 16 géneros

``` {r movies}
datos <- read.csv("movies.csv")

# Crear gráfico de barras
barplot(datos$genresAmount, main = "Promedio de Películas por Mes", xlab = "Mes", ylab = "Cantidad Promedio de Películas")

```

En el gráfico se puede observar la generalidad de cantidad de génerospor película, 
el dato que sobresale es el máximo anteriormente expuesto "Live Spectale NARUTO -Song of the Akatsuki-", 
las demás permanecen dentro de un rango promedio entre 3 y 7 géneros.

### 5.5 ¿Existe algun tipo de relación entre el presupuesto y la cantidad de países de grabación?
``` {r movies}
# Convertir las columnas productionCountriesAmount y budget a formato numérico
datos$actorsAmount <- as.numeric(datos$productionCountriesAmount)
datos$runtime <- as.numeric(datos$budget)

# Excluir filas con valores de 0 o NA
datos_filtrados <- subset(datos, productionCountriesAmount != 0 & budget != 0 & !is.na(productionCountriesAmount) & !is.na(budget))

# Calcular la correlación entre productionCountriesAmount y budget en los datos filtrados
correlation <- cor(datos_filtrados$productionCountriesAmount, datos_filtrados$budget)
correlation

# Diagrama de dispersión entre productionCountriesAmount y budget en los datos filtrados
ggplot(datos_filtrados, aes(x = budget, y = productionCountriesAmount)) +
  geom_point(alpha = 0.6) +
  labs(title = "Diagrama de Dispersión entre Cantidad de Países de Grabación y Presupuesto",
       label = paste("Correlación:", round(correlation, 2)),
       x = "Presupuesto",
       y = "Cantidad de Países") +
  scale_y_continuous(limits = c(0, max(datos_filtrados$productionCountriesAmount))) +
  theme_minimal()

```
No existe ningún tipo de relación entre el presupuesto y la cantidad de países de grabación, 
esto se ve corroborado por nuestro índice y el gráfico generado. Este último demuestra
incluso que las pelícunas grabadas en una mayor cantidad de países no poseían un 
presupuesto demasiado grande en comparación a otras películas.

### 5.6 ¿Cuántas películas se han grabado para cada idioma?
``` {r movies}

# Contabilizar películas y agruparlas según su idioma original
frecuencia_idiomas <- table(datos$originalLanguage)

print(frecuencia_idiomas)

# Generar el gráfico de barras
barplot(frecuencia_idiomas, 
        main = "Cantidad de Películas por Idioma Original",
        xlab = "Idioma Original",
        ylab = "Cantidad de Películas")

```

Cómo se puede observar en la gráfica de barras generada, el idioma original con más
cantidad de películas es el inglés con un total de 7772 películas, seguido del japonés
con 644 películas, y del español con 425 películas respectivamente.
