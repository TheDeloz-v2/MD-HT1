---
title: "MD-HT1"
output: html_document
date: "2024-01-25"
---

## Carga de datos

```{r setup, include=FALSE}
datos <- read.csv("movies.csv")
```

## 1. Resumen de nuestro conjunto de datos

```{r movies}
summary(datos)
```

## 2. Diga el tipo de cada una de las variables (cualitativa ordinal o nominal, cuantitativa continua, cuantitativa discreta)

```{r movies}
if (!requireNamespace("knitr", quietly = TRUE)) {
  install.packages("knitr")
}

library(knitr)
# Definir manualmente los tipos de variables que son cada una
tipo <- c("Cuantitativa discreta", "Cuantitativa continua", "Cualitativa nominal",
                    "Cualitativa nominal", "Cualitativa nominal", "Cualitativa nominal",
                    "Cualitativa nominal", "Cuantitativa continua",
                    "Cuantitativa continua", "Cualitativa nominal", "Cualitativa nominal",
                    "Cualitativa nominal", "Cuantitativa continua", "Cualitativa nominal",
                    "Cualitativa nominal", "Cualitativa nominal", "Cualitativa nominal",
                    "Cuantitativa continua", "Cualitativa nominal", "Cuantitativa continua",
                    "Cuantitativa discreta", "Cuantitativa discreta", "Cuantitativa discreta",
                    "Cuantitativa discreta", "Cuantitativa discreta", "Cuantitativa discreta",
                    "Cuantitativa discreta")

# Crear un dataframe con los nombres de las columnas y los tipos que son
tabla_columnas_valores <- data.frame(Variables = colnames(datos), TipoVariable = tipo)

# Imprimir la tabla usando kable()
kable(tabla_columnas_valores, format = "html", row.names = TRUE)
```

## 3. Investigue si las variables cuantitativas siguen una distribución normal y haga una tabla de frecuencias de las variables cualitativas. Explique todos los resultados.

### budget
```{r movies}
# Descargamos ggplot2
if (!requireNamespace("ggplot2", quietly = TRUE)) {
  install.packages("ggplot2")
}
library(ggplot2)

# Tomemos 'budget' como ejemplo
budget_data <- datos$budget

# Crear histograma
hist_plot <- ggplot(data.frame(x = budget_data), aes(x = x)) +
  geom_histogram(binwidth = 50000000, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de Budget",
       x = "Budget",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = budget_data), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de Budget",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```
### revenue
```{r movies}
library(ggplot2)

# Tomemos 'revenue' como ejemplo
revenue_data <- datos$revenue

# Crear histograma
hist_plot <- ggplot(data.frame(x = revenue_data), aes(x = x)) +
  geom_histogram(binwidth = 50000000, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de revenue",
       x = "revenue",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = revenue_data), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de revenue",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```
### runtime
```{r movies}
library(ggplot2)

# Tomemos 'runtime' como ejemplo
runtime_data <- datos$runtime

# Crear histograma
hist_plot <- ggplot(data.frame(x = runtime_data), aes(x = x)) +
  geom_histogram(binwidth = 10, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de runtime",
       x = "runtime",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = runtime_data), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de runtime",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```
### actorsPopularity
```{r movies}
library(ggplot2)

# Tomemos 'actorsPopularity' como ejemplo
actorsPopularity_data <- datos$actorsPopularity

# Crear histograma
hist_plot <- ggplot(data.frame(x = actorsPopularity_data), aes(x = x)) +
  geom_histogram(binwidth = 10, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de actorsPopularity",
       x = "actorsPopularity",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = actorsPopularity_data), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de actorsPopularity",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```
### popularity
```{r movies}
library(ggplot2)

# Tomemos 'popularity' como ejemplo
popularity_data <- datos$popularity

# Crear histograma
hist_plot <- ggplot(data.frame(x = popularity_data), aes(x = x)) +
  geom_histogram(binwidth = 50, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de popularity",
       x = "popularity",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = popularity_data), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de popularity",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```
### voteAvg
```{r movies}
library(ggplot2)

# Tomemos 'voteAvg' como ejemplo
voteAvg_data <- datos$voteAvg

# Crear histograma
hist_plot <- ggplot(data.frame(x = voteAvg_data), aes(x = x)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de voteAvg",
       x = "voteAvg",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = voteAvg_data), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de voteAvg",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```
### voteCount
```{r movies}
library(ggplot2)

# Tomemos 'voteCount' como ejemplo
voteCount_data <- datos$voteCount

# Crear histograma
hist_plot <- ggplot(data.frame(x = voteCount_data), aes(x = x)) +
  geom_histogram(binwidth = 50, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de voteCount",
       x = "voteCount",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = voteCount_data), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de voteCount",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```
### genresAmount
```{r movies}
library(ggplot2)

# Tomemos 'genresAmount' como ejemplo
genresAmount_data <- datos$genresAmount

# Crear histograma
hist_plot <- ggplot(data.frame(x = genresAmount_data), aes(x = x)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de genresAmount",
       x = "genresAmount",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = genresAmount_data), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de genresAmount",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```
### productionCoAmount
```{r movies}
library(ggplot2)

# Tomemos 'productionCoAmount' como ejemplo
productionCoAmount_data <- datos$productionCoAmount

# Crear histograma
hist_plot <- ggplot(data.frame(x = productionCoAmount_data), aes(x = x)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de productionCoAmount",
       x = "productionCoAmount",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = productionCoAmount_data), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de productionCoAmount",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```
### productionCountriesAmount
```{r movies}
library(ggplot2)

productionCountriesAmount_data <- datos$productionCountriesAmount

# Crear histograma
hist_plot <- ggplot(data.frame(x = productionCountriesAmount_data), aes(x = x)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de productionCountriesAmount",
       x = "productionCountriesAmount",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = productionCountriesAmount_data), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de productionCountriesAmount",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```
### actorsAmount
```{r movies}
library(ggplot2)

actorsAmount_data <- datos$actorsAmount

# Crear histograma
hist_plot <- ggplot(data.frame(x = actorsAmount_data ), aes(x = x)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de actorsAmount",
       x = "actorsAmount",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = actorsAmount_data ), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de actorsAmount",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```
### castWomenAmount
```{r movies}
library(ggplot2)
castWomenAmount_data <- datos$castWomenAmount

# Crear histograma
hist_plot <- ggplot(data.frame(x = castWomenAmount_data ), aes(x = x)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de Budget",
       x = "castWomenAmount",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = castWomenAmount_data ), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de Budget",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```
### castMenAmount
```{r movies}
library(ggplot2)
castMenAmount_data <- datos$castMenAmount

# Crear histograma
hist_plot <- ggplot(data.frame(x = castMenAmount_data ), aes(x = x)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histograma de castMenAmount",
       x = "castWomenAmount",
       y = "Frecuencia")

# Crear QQ-Plot
qq_plot <- ggplot(data.frame(x = castMenAmount_data ), aes(sample = x)) +
  geom_qq() +
  geom_qq_line(color = "blue") +
  labs(title = "QQ-Plot de castMenAmount",
       x = "Cuantiles teóricos",
       y = "Cuantiles observados")

# Imprimir los gráficos
print(hist_plot)
print(qq_plot)
```
### Genres

```{r movies}
# Crear tabla de frecuencias para la variable "genres"
genres_sep <- strsplit(as.character(datos$genres), "\\|")
genres_sep <- data.frame(genres = unlist(genres_sep))
genres_table <- as.data.frame(table(genres_sep))
colnames(genres_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  genres_table$Valor <- iconv(genres_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(genres_table))
})
```

### productionCompany

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "productionCompany"
productionCompany_sep <- strsplit(as.character(datos$productionCompany), "\\|")
productionCompany_sep <- data.frame(productionCompany = unlist(productionCompany_sep))
productionCompany_table <- as.data.frame(table(productionCompany_sep))
colnames(productionCompany_table) <- c("Valor", "Frecuencia")

# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Filtrar valores que contienen caracteres no deseados
  productionCompany_table <- productionCompany_table[!grepl("<U\\+", productionCompany_table$Valor), ]
  
  # Convertir las cadenas antes de imprimir
  productionCompany_table$Valor <- iconv(productionCompany_table$Valor, to = "UTF-8", sub = "byte")
  
  # Imprimir solo las primeras filas de la tabla
  print(head(productionCompany_table))
})

```

### productionCompanyCountry

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "productionCompanyCountry"
productionCompanyCountry_sep <- strsplit(as.character(datos$productionCompanyCountry), "\\|")
productionCompanyCountry_sep <- data.frame(productionCompanyCountry = unlist(productionCompanyCountry_sep))
productionCompany_table <- as.data.frame(table(productionCompanyCountry_sep))
colnames(productionCompany_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  productionCompany_table$Valor <- iconv(productionCompany_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(productionCompany_table))
})
```

### productionCountry

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "productionCountry"
productionCountry_sep <- strsplit(as.character(datos$productionCountry), "\\|")
productionCountry_sep <- data.frame(productionCountry = unlist(productionCountry_sep))
productionCountry_table <- as.data.frame(table(productionCountry_sep))
colnames(productionCountry_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  productionCountry_table$Valor <- iconv(productionCountry_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(productionCountry_table))
})
```

### video

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "video"
video_sep <- strsplit(as.character(datos$video), "\\|")
video_sep <- data.frame(video = unlist(video_sep))
video_table <- as.data.frame(table(video_sep))
colnames(video_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  video_table$Valor <- iconv(video_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(video_table))
})
```

### director

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "director"
director_sep <- strsplit(as.character(datos$director), "\\|")
director_sep <- data.frame(director = unlist(director_sep))
director_table <- as.data.frame(table(director_sep))
colnames(director_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  director_table$Valor <- iconv(director_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(director_table))
})
```

### actors

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "actors"
actors_sep <- strsplit(as.character(datos$actors), "\\|")
actors_sep <- data.frame(actors = unlist(actors_sep))
actors_table <- as.data.frame(table(actors_sep))
colnames(actors_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  actors_table$Valor <- iconv(actors_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(actors_table))
})
```

### actorsCharacter

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "actorsCharacter"
actorsCharacter_sep <- strsplit(as.character(datos$actorsCharacter), "\\|")
actorsCharacter_sep <- data.frame(actorsCharacter = unlist(actorsCharacter_sep))
actorsCharacter_table <- as.data.frame(table(actorsCharacter_sep))
colnames(actorsCharacter_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  actorsCharacter_table$Valor <- iconv(actorsCharacter_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(actorsCharacter_table))
})
```

### originalTitle

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "originalTitle"
originalTitle_sep <- strsplit(as.character(datos$originalTitle), "\\|")
originalTitle_sep <- data.frame(originalTitle = unlist(originalTitle_sep))
originalTitle_table <- as.data.frame(table(originalTitle_sep))
colnames(originalTitle_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  originalTitle_table$Valor <- iconv(originalTitle_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(originalTitle_table))
})
```

### title

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "title"
title_sep <- strsplit(as.character(datos$title), "\\|")
title_sep <- data.frame(title = unlist(title_sep))
title_table <- as.data.frame(table(title_sep))
colnames(title_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  title_table$Valor <- iconv(title_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(title_table))
})
```

### originalLanguage

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "originalLanguage"
originalLanguage_sep <- strsplit(as.character(datos$originalLanguage), "\\|")
originalLanguage_sep <- data.frame(originalLanguage = unlist(originalLanguage_sep))
originalLanguage_table <- as.data.frame(table(originalLanguage_sep))
colnames(originalLanguage_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  originalLanguage_table$Valor <- iconv(originalLanguage_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(originalLanguage_table))
})
```

### releaseDate

```{r movies , echo=FALSE}
# Crear tabla de frecuencias para la variable "releaseDate"
releaseDate_sep <- strsplit(as.character(datos$releaseDate), "\\|")
releaseDate_sep <- data.frame(releaseDate = unlist(releaseDate_sep))
releaseDate_table <- as.data.frame(table(releaseDate_sep))
colnames(releaseDate_table) <- c("Valor", "Frecuencia")
# Suprimir advertencias solo para la conversión
suppressWarnings({
  # Convertir las cadenas antes de imprimir
  releaseDate_table$Valor <- iconv(releaseDate_table$Valor, to = "UTF-8", sub = "byte")
  # Imprimir solo las primeras filas de la tabla
  print(head(releaseDate_table))
})
```

## 4.Responda las siguientes preguntas:

### 4.1 ¿Cuáles son las 10 películas que contaron con más presupuesto?
```{r movies}
# Instalar y cargar el paquete dplyr si aún no está instalado
if (!requireNamespace("dplyr", quietly = TRUE)) {
  install.packages("dplyr")
}

library(dplyr)


# Seleccionar las primeras 10 filas
top_10_presupuesto <- head(datos[order(-datos$budget), ], 10)

# Imprimir el resultado
print(top_10_presupuesto[, c("title", "budget")])
```
### 4.2 ¿Cuáles son las 10 películas que más ingresos tuvieron?
```{r movies}

# Seleccionar las primeras 10 filas
top_10_ingresos <- head(datos[order(-datos$revenue), ], 10)

# Imprimir el resultado
print(top_10_ingresos[, c("title", "revenue")])
```

### 4.3  ¿Cuál es la película que más votos tuvo?
```{r movies}

# Seleccionar las primeras 10 filas
top_voteCount <- head(datos[order(-datos$voteCount), ], 1)

# Imprimir el resultado
print(top_voteCount[, c("title", "voteCount")])
```
### 4.4  ¿Cuál es la peor película de acuerdo a los votos de todos los usuarios?
```{r movies}

# Seleccionar las primeras 10 filas
worst_voteAvg <- head(datos[order(datos$voteAvg), ], 1)

# Imprimir el resultado
print(worst_voteAvg[, c("title", "voteAvg")])
```

### 4.5 ¿Cuántas películas se hicieron en cada año? ¿En qué año se hicieron más películas? Haga un gráfico de barras


### 4.6 ¿Cuál es el género principal de las 20 películas más recientes? ¿Cuál es el género principal que predomina en el conjunto de datos? Represéntelo usando un gráfico


